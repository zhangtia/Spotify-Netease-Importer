(this["webpackJsonpplaylist-importer"]=this["webpackJsonpplaylist-importer"]||[]).push([[0],[,,,,,,,,,,function(e,t,a){e.exports=a(18)},,,,,function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){"use strict";a.r(t);var s=a(0),n=a.n(s),i=a(9),l=a.n(i),c=(a(15),a(3)),o=a(4),r=a(5),u=a(1),m=a(7),p=a(6),h=a(2),d=["user-top-read","user-read-currently-playing","user-read-playback-state","playlist-modify-public","playlist-modify-private"],g=window.location.hash.substring(1).split("&").reduce((function(e,t){if(t){var a=t.split("=");e[a[0]]=decodeURIComponent(a[1])}return e}),{});window.location.hash="";var y=g,f=(a(16),function(e){Object(m.a)(a,e);var t=Object(p.a)(a);function a(){return Object(o.a)(this,a),t.apply(this,arguments)}return Object(r.a)(a,[{key:"render",value:function(){var e=this;return n.a.createElement("div",{className:"App-playlist"},this.props.playlists.map((function(t){return n.a.createElement("div",{key:t.id,onClick:function(){return e.props.action(t.id)}},n.a.createElement("div",{className:"main-wrapper btn",style:{background:e.props.selected===t.id?"#1ecd97":"",color:e.props.selected===t.id?"#333":""}},n.a.createElement("div",{className:"now-playing__img"},n.a.createElement("img",{className:"album-img",src:0!==t.images.length?t.images[0].url:"https://img.icons8.com/material-sharp/24/000000/no-image.png",alt:"album-cover"})),n.a.createElement("div",{className:"now-playing__side"},n.a.createElement("div",{className:"now-playing__name"},t.name)),n.a.createElement("div",{className:"background",style:{backgroundImage:"url(".concat(0!==t.images.length?t.images[0].url:"https://img.icons8.com/material-sharp/24/000000/no-image.png",")")}})," "))})))}}]),a}(s.Component)),E=(a(17),function(e){Object(m.a)(a,e);var t=Object(p.a)(a);function a(e){var s;return Object(o.a)(this,a),(s=t.call(this,e)).state={token:null,display_name:"not logged in",playlists:[],neteasesearch:2842615416,NEsongs:[],sel_playlist:null,songs_to_import:[]},s.hi=s.hi.bind(Object(u.a)(s)),s.getPlaylists=s.getPlaylists.bind(Object(u.a)(s)),s.getNetease=s.getNetease.bind(Object(u.a)(s)),s.searchSong=s.searchSong.bind(Object(u.a)(s)),s.importSongs=s.importSongs.bind(Object(u.a)(s)),s.selectPlaylist=s.selectPlaylist.bind(Object(u.a)(s)),s.handleChange=s.handleChange.bind(Object(u.a)(s)),s.selectAll=s.selectAll.bind(Object(u.a)(s)),s}return Object(r.a)(a,[{key:"componentDidMount",value:function(){var e=y.access_token;e&&(this.setState({token:e}),this.hi(e),this.getPlaylists(e))}},{key:"hi",value:function(e){var t=this;h.ajax({url:"https://api.spotify.com/v1/me",type:"GET",beforeSend:function(t){t.setRequestHeader("Authorization","Bearer "+e)},success:function(e){t.setState({display_name:e.display_name})}})}},{key:"getPlaylists",value:function(e){var t=this;h.ajax({url:"https://api.spotify.com/v1/me/playlists",type:"GET",data:{limit:50,offset:0},beforeSend:function(t){t.setRequestHeader("Authorization","Bearer "+e)},success:function(e){t.setState({playlists:e.items})}})}},{key:"importSongs",value:function(){var e=this;if(null!==this.state.sel_playlist){var t=Object(c.a)(this.state.NEsongs),a=[],s="";t.forEach((function(e,t){t%50===0&&(a.push(s.substring(0,s.length-1)),s=""),e[4]&&(s=s+e[5]+",",e[4]=!e[4])})),a.push(s.substring(0,s.length-1)),a.forEach((function(a){h.ajax({url:"\thttps://api.spotify.com/v1/playlists/"+e.state.sel_playlist+"/tracks?"+h.param({uris:a}),type:"POST",beforeSend:function(t){t.setRequestHeader("Authorization","Bearer "+e.state.token)},success:function(a){e.setState({NEsongs:t})}})}))}else alert("Please select a playlist")}},{key:"searchSong",value:function(e,t){var a=this;h.ajax({url:"https://api.spotify.com/v1/search",type:"GET",data:{q:"track:'"+e+"' artist:'"+t+"'",type:"track",limit:1},beforeSend:function(e){e.setRequestHeader("Authorization","Bearer "+a.state.token)},success:function(s){0!==s.tracks.items.length?a.setState((function(a){return{NEsongs:[].concat(Object(c.a)(a.NEsongs),[[e,t,s.tracks.items[0].name,s.tracks.items[0].artists[0].name,!1,s.tracks.items[0].uri]])}})):a.setState((function(a){return{NEsongs:[].concat(Object(c.a)(a.NEsongs),[[e,t,"N/A","N/A",!1,""]])}}))}})}},{key:"getNetease",value:function(e){var t=this;e.preventDefault(),this.setState({NEsongs:[]}),h.ajax({url:"https://musicapi.leanapp.cn/playlist/detail",type:"GET",data:{id:this.state.neteasesearch},success:function(e){console.log(e),200===e.code?e.playlist.trackIds.forEach((function(e){h.ajax({url:"https://musicapi.leanapp.cn/song/detail",type:"GET",data:{ids:e.id},success:function(e){t.searchSong(e.songs[0].name,e.songs[0].ar[0].name)}})})):alert("Error fetching playlist")}})}},{key:"selectSong",value:function(e,t){t.preventDefault();var a=Object(c.a)(this.state.NEsongs);"N/A"!==a[e][3]&&(a[e][4]=!a[e][4],this.setState({NEsongs:a}))}},{key:"selectPlaylist",value:function(e){this.setState({sel_playlist:e})}},{key:"handleChange",value:function(e){this.setState({neteasesearch:e.target.value})}},{key:"selectAll",value:function(){var e=Object(c.a)(this.state.NEsongs);e.forEach((function(e){"N/A"!==e[3]&&(e[4]=!0)})),this.setState({NEsongs:e})}},{key:"render",value:function(){var e=this;return n.a.createElement("div",{className:"App"},n.a.createElement("div",{id:"col1"},this.state.token&&n.a.createElement("form",{onSubmit:this.getNetease},n.a.createElement("label",null,n.a.createElement("input",{type:"text",name:"url",value:this.state.neteasesearch,onChange:this.handleChange,className:"input-field"})),n.a.createElement("input",{type:"submit",value:"get playlist",className:"submit-btn"})),0!==this.state.NEsongs.length&&n.a.createElement("button",{onClick:this.importSongs,className:"btn"},"IMPORT"),0!==this.state.NEsongs.length&&n.a.createElement("button",{onClick:this.selectAll,className:"btn"},"SELECT ALL")),n.a.createElement("div",{id:"col2"},!this.state.token&&n.a.createElement("header",{className:"App-header"},n.a.createElement("a",{className:"btn btn--loginApp-link",href:"".concat("https://accounts.spotify.com/authorize","?client_id=").concat("60707a33a22f4caaa987faa27cd9251b","&redirect_uri=").concat("https://zhangtia.github.io/Spotify-Netease-Importer/","&scope=").concat(d.join("%20"),"&response_type=token&show_dialog=true")},"Login to Spotify")),this.state.token&&n.a.createElement("table",{className:"Song-list"},n.a.createElement("thead",null,n.a.createElement("tr",null,n.a.createElement("th",{style:{fontSize:"0.7em"}},"Netease"),n.a.createElement("th",{style:{fontSize:"0.7em"}},"Spotify"),n.a.createElement("th",{style:{fontSize:"0.7em"}},"Import?"))),n.a.createElement("tbody",null,this.state.NEsongs.map((function(t,a){return n.a.createElement("tr",{key:t[0],onClick:e.selectSong.bind(e,a),className:"Song-row"},n.a.createElement("td",{style:{background:t[4]?"#1ecd97":"",color:t[4]?"#333":""}},n.a.createElement("p",{className:"Song-name"},t[0]),n.a.createElement("p",{className:"Artist-name"},t[1])),n.a.createElement("td",{style:{background:t[4]?"#1ecd97":"",color:t[4]?"#333":""}},n.a.createElement("p",{className:"Song-name"},t[2]),n.a.createElement("p",{className:"Artist-name"},t[3])),n.a.createElement("td",{style:{background:t[4]?"#1ecd97":"",color:t[4]?"#333":""}},"[]"))}))))),n.a.createElement("div",{id:"col3",style:{width:this.state.token?"25%":"100%"}},this.state.token&&n.a.createElement("div",null,n.a.createElement(f,{playlists:this.state.playlists,action:this.selectPlaylist,selected:this.state.sel_playlist})),this.state.display_name))}}]),a}(s.Component));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));l.a.render(n.a.createElement(n.a.StrictMode,null,n.a.createElement(E,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}],[[10,1,2]]]);
//# sourceMappingURL=main.db383004.chunk.js.map