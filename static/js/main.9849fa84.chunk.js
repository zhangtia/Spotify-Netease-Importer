(this["webpackJsonpplaylist-importer"]=this["webpackJsonpplaylist-importer"]||[]).push([[0],[,,,,,,,,function(t,e,a){},,,function(t,e,a){t.exports=a.p+"static/media/Tutorial.31b792ab.png"},function(t,e,a){t.exports=a.p+"static/media/mygif.6758da32.gif"},function(t,e,a){t.exports=a(20)},,,,,function(t,e,a){},function(t,e,a){},function(t,e,a){"use strict";a.r(e);var s=a(0),n=a.n(s),i=a(10),l=a.n(i),c=(a(18),a(7)),r=a(3),o=a(4),u=a(1),p=a(6),m=a(5),h=a(2),g=["playlist-modify-public","playlist-modify-private"],d=window.location.hash.substring(1).split("&").reduce((function(t,e){if(e){var a=e.split("=");t[a[0]]=decodeURIComponent(a[1])}return t}),{});window.location.hash="";var y=d,f=(a(8),function(t){Object(p.a)(a,t);var e=Object(m.a)(a);function a(){return Object(r.a)(this,a),e.apply(this,arguments)}return Object(o.a)(a,[{key:"render",value:function(){var t=this;return n.a.createElement("div",{className:"App-playlist"},this.props.playlists.map((function(e){return n.a.createElement("div",{key:e.id,onClick:function(){return t.props.action(e.id)}},n.a.createElement("div",{className:"main-wrapper btn",style:{background:t.props.selected===e.id?"#1ecd97":"",color:t.props.selected===e.id?"#333":""}},n.a.createElement("div",{className:"now-playing__img"},n.a.createElement("img",{className:"album-img",src:0!==e.images.length?e.images[0].url:"https://img.icons8.com/material-sharp/24/000000/no-image.png",alt:"album-cover"})),n.a.createElement("div",{className:"now-playing__side"},n.a.createElement("div",{className:"now-playing__name"},e.name))))})))}}]),a}(s.Component)),b=(a(19),a(11)),E=a.n(b),v=function(t){Object(p.a)(a,t);var e=Object(m.a)(a);function a(){return Object(r.a)(this,a),e.apply(this,arguments)}return Object(o.a)(a,[{key:"render",value:function(){var t=this;return n.a.createElement("div",{className:"Intro"},n.a.createElement("p",{className:"Intro-text"},"Start by searching up a playlist ID, or pick one from the trending playlists!"),n.a.createElement("table",{className:"Intro-list"},n.a.createElement("thead",null,n.a.createElement("tr",null,n.a.createElement("th",{style:{fontSize:"1em"}},"Hot Playlists"))),n.a.createElement("tbody",null,this.props.data.map((function(e){return n.a.createElement("tr",{key:e.id,onClick:function(){return t.props.action(e.id)},className:"Song-row"},n.a.createElement("td",null,e.name))})))),n.a.createElement("img",{className:"Intro-pic",src:E.a,alt:"album-cover"}))}}]),a}(s.Component),k=a(12),N=a.n(k),S=function(t){Object(p.a)(a,t);var e=Object(m.a)(a);function a(){return Object(r.a)(this,a),e.apply(this,arguments)}return Object(o.a)(a,[{key:"render",value:function(){return n.a.createElement("div",{className:"Landing"},n.a.createElement("a",{className:"btn btn--login App-link",href:"".concat("https://accounts.spotify.com/authorize","?client_id=").concat("60707a33a22f4caaa987faa27cd9251b","&redirect_uri=").concat("https://zhangtia.github.io/Spotify-Netease-Importer/","&scope=").concat(g.join("%20"),"&response_type=token&show_dialog=true")},"Login to Spotify"),n.a.createElement("img",{className:"Landing-gif",src:N.a,alt:"netease-spotify-gif"}))}}]),a}(s.Component),_=function(t){Object(p.a)(a,t);var e=Object(m.a)(a);function a(t){var s;return Object(r.a)(this,a),(s=e.call(this,t)).state={token:null,display_name:"Not logged in",display_pic:null,playlists:[],neteasesearch:463126179,NEsongs:[],sel_playlist:null,songs_to_import:[],current_page:0,step_nbr:1,recommended:[],loading:!1},s.trendingPlaylist=s.trendingPlaylist.bind(Object(u.a)(s)),s.hi=s.hi.bind(Object(u.a)(s)),s.getPlaylists=s.getPlaylists.bind(Object(u.a)(s)),s.getNetease=s.getNetease.bind(Object(u.a)(s)),s.searchSong=s.searchSong.bind(Object(u.a)(s)),s.importSongs=s.importSongs.bind(Object(u.a)(s)),s.selectPlaylist=s.selectPlaylist.bind(Object(u.a)(s)),s.handleChange=s.handleChange.bind(Object(u.a)(s)),s.selectAll=s.selectAll.bind(Object(u.a)(s)),s.prevPage=s.prevPage.bind(Object(u.a)(s)),s.nextPage=s.nextPage.bind(Object(u.a)(s)),s.testFunction=s.testFunction.bind(Object(u.a)(s)),s.selectRecommended=s.selectRecommended.bind(Object(u.a)(s)),s.getCookies=s.getCookies.bind(Object(u.a)(s)),s}return Object(o.a)(a,[{key:"componentDidMount",value:function(){var t=y.access_token;if(t){if(this.setState({token:t}),y.expires_in){var e=new Date;e.setTime(e.getTime()+100*parseInt(y.expires_in));var a="; expires="+e.toUTCString();document.cookie="SpotifyAuth="+(y.access_token||"")+a+"; path=/"}this.hi(t),this.getPlaylists(t),this.trendingPlaylist()}this.getCookies()&&(t=this.getCookies(),this.setState({token:t}),this.hi(t),this.getPlaylists(t),this.trendingPlaylist())}},{key:"getCookies",value:function(){for(var t=document.cookie.split(";"),e=0;e<t.length;e++){for(var a=t[e];" "===a.charAt(0);)a=a.substring(1,a.length);if(0===a.indexOf("SpotifyAuth="))return a.substring("SpotifyAuth=".length,a.length)}return null}},{key:"trendingPlaylist",value:function(){var t=this;h.ajax({url:"https://musicapi.leanapp.cn/top/playlist",type:"GET",data:{limit:5,cat:"\u6b27\u7f8e"},success:function(e){t.setState({recommended:e.playlists})}})}},{key:"hi",value:function(t){var e=this;h.ajax({url:"https://api.spotify.com/v1/me",type:"GET",beforeSend:function(e){e.setRequestHeader("Authorization","Bearer "+t)},success:function(t){e.setState({display_name:t.display_name,display_pic:t.images[0].url})}})}},{key:"getPlaylists",value:function(t){var e=this;h.ajax({url:"https://api.spotify.com/v1/me/playlists",type:"GET",data:{limit:50,offset:0},beforeSend:function(e){e.setRequestHeader("Authorization","Bearer "+t)},success:function(t){e.setState({playlists:t.items})}})}},{key:"importSongs",value:function(){var t=this;if(null!==this.state.sel_playlist){var e=Object(c.a)(this.state.NEsongs),a=[],s="";e.forEach((function(t,e){e%50===0&&0!==e&&(a.push(s.substring(0,s.length-1)),s=""),t[4]&&(s=s+t[5]+",",t[4]=!t[4])})),a.push(s.substring(0,s.length-1)),a.forEach((function(e){h.ajax({url:"https://api.spotify.com/v1/playlists/"+t.state.sel_playlist+"/tracks?"+h.param({uris:e}),type:"POST",beforeSend:function(e){e.setRequestHeader("Authorization","Bearer "+t.state.token)},statusCode:{500:function(){a.push(e)}}})})),this.setState({NEsongs:e})}else alert("Please select a playlist")}},{key:"searchSong",value:function(t,e){var a=this;h.ajax({url:"https://api.spotify.com/v1/search",type:"GET",data:{q:"track:'"+t+"' artist:'"+e+"'",type:"track",limit:1},beforeSend:function(t){t.setRequestHeader("Authorization","Bearer "+a.state.token)},success:function(s){0!==s.tracks.items.length?a.setState((function(a){return{NEsongs:[].concat(Object(c.a)(a.NEsongs),[[t,e,s.tracks.items[0].name,s.tracks.items[0].artists[0].name,!1,s.tracks.items[0].uri]])}})):a.setState((function(a){return{NEsongs:[].concat(Object(c.a)(a.NEsongs),[[t,e,"N/A","N/A",!1,""]])}}))}})}},{key:"getNetease",value:function(t){var e=this;this.setState({NEsongs:[],step_nbr:2,loading:!0}),h.ajax({url:"https://musicapi.leanapp.cn/playlist/detail",type:"GET",data:{id:this.state.neteasesearch},success:function(t){200===t.code?t.playlist.trackIds.forEach((function(t){h.ajax({url:"https://musicapi.leanapp.cn/song/detail",type:"GET",data:{ids:t.id},success:function(t){e.searchSong(t.songs[0].name,t.songs[0].ar[0].name)}})})):alert("Error fetching playlist")}}),this.setState({loading:!1})}},{key:"selectSong",value:function(t,e){e.preventDefault();var a=Object(c.a)(this.state.NEsongs);"N/A"!==a[t][3]&&(a[t][4]=!a[t][4],this.setState({NEsongs:a}))}},{key:"selectPlaylist",value:function(t){this.setState({sel_playlist:t})}},{key:"handleChange",value:function(t){this.setState({neteasesearch:t.target.value})}},{key:"selectAll",value:function(){var t=Object(c.a)(this.state.NEsongs);t.forEach((function(t){"N/A"!==t[3]&&(t[4]=!0)})),this.setState({NEsongs:t})}},{key:"prevPage",value:function(){if(this.state.current_page>0){var t=this.state.current_page-1;this.setState({current_page:t})}}},{key:"nextPage",value:function(){if(20*(this.state.current_page+1)<this.state.NEsongs.length){var t=this.state.current_page+1;this.setState({current_page:t})}}},{key:"testFunction",value:function(t){this.setState({step_nbr:t})}},{key:"selectRecommended",value:function(t){var e=this;this.setState({neteasesearch:t,step_nbr:2,NEsongs:[]}),h.ajax({url:"https://musicapi.leanapp.cn/playlist/detail",type:"GET",data:{id:t},success:function(t){200===t.code?t.playlist.trackIds.forEach((function(t){h.ajax({url:"https://musicapi.leanapp.cn/song/detail",type:"GET",data:{ids:t.id},success:function(t){e.searchSong(t.songs[0].name,t.songs[0].ar[0].name)}})})):alert("Error fetching playlist")}})}},{key:"render",value:function(){var t=this;return n.a.createElement("div",{className:"App"},n.a.createElement("ul",{className:"navbar"},this.state.display_pic&&n.a.createElement("li",{className:"logged-in-as"},n.a.createElement("img",{className:"profile-img",src:this.state.display_pic,alt:"profile-pic"}),this.state.display_name," ")),n.a.createElement("div",{id:"col1",style:{width:1===this.state.step_nbr?"100%":"0%"}},this.state.token&&this.state.NEsongs.length>0&&n.a.createElement("div",{className:"dud-btn",style:{float:"left"}},">>>>>"),this.state.token&&this.state.NEsongs.length>0&&n.a.createElement("button",{onClick:function(){return t.testFunction(2)},className:"btn",style:{float:"right"}},">>>>>"),!this.state.token&&n.a.createElement(S,null),this.state.token&&1===this.state.step_nbr&&n.a.createElement("form",{onSubmit:this.getNetease},n.a.createElement("label",null,n.a.createElement("input",{type:"text",name:"user",value:this.state.neteasesearch,onChange:this.handleChange,className:"input-field"})),n.a.createElement("input",{type:"submit",value:"get playlist",className:"submit-btn"})),this.state.token&&1===this.state.step_nbr&&n.a.createElement(v,{action:this.selectRecommended,data:this.state.recommended})),n.a.createElement("div",{id:"col2",style:{width:2===this.state.step_nbr?"100%":"0%"}},n.a.createElement("button",{onClick:function(){return t.testFunction(1)},className:"btn",style:{float:"left"}},"<<<<<"),n.a.createElement("button",{onClick:function(){return t.testFunction(3)},className:"btn",style:{float:"right"}},">>>>>"),!this.state.loading&&0!==this.state.NEsongs.length&&2===this.state.step_nbr&&n.a.createElement("div",{className:"control-panel"},n.a.createElement("button",{onClick:this.selectAll,className:"btn"},"SELECT ALL"),n.a.createElement("button",{onClick:this.prevPage,className:"page-btn left-space"},"Previous Page"),this.state.current_page+1,n.a.createElement("button",{onClick:this.nextPage,className:"page-btn"},"Next Page")),this.state.token&&2===this.state.step_nbr&&n.a.createElement("p",{className:"Song-text"},"Select songs from playlist to import to Spotify"),this.state.token&&2===this.state.step_nbr&&n.a.createElement("table",{className:"Song-list"},n.a.createElement("thead",null,n.a.createElement("tr",null,n.a.createElement("th",{style:{fontSize:"0.7em"}},"Netease"),n.a.createElement("th",{style:{fontSize:"0.7em"}},"Spotify"),n.a.createElement("th",{style:{fontSize:"0.7em"}},"Import?"))),n.a.createElement("tbody",null,this.state.NEsongs.slice(20*this.state.current_page,20*(this.state.current_page+1)).map((function(e,a){return n.a.createElement("tr",{key:e[0],onClick:t.selectSong.bind(t,20*t.state.current_page+a),className:"Song-row"},n.a.createElement("td",{style:{background:e[4]?"#1ecd97":"",color:e[4]?"#333":""}},n.a.createElement("p",{className:"Song-name"},e[0]),n.a.createElement("p",{className:"Artist-name"},e[1])),n.a.createElement("td",{style:{background:e[4]?"#1ecd97":"",color:e[4]?"#333":""}},n.a.createElement("p",{className:"Song-name"},e[2]),n.a.createElement("p",{className:"Artist-name"},e[3])),n.a.createElement("td",{style:{background:e[4]?"#1ecd97":"",color:e[4]?"#333":""}},"[]"))})))),0!==this.state.NEsongs.length&&2===this.state.step_nbr&&n.a.createElement("div",{className:"page-index"},n.a.createElement("button",{onClick:this.prevPage,className:"page-btn left-space"},"Previous Page"),this.state.current_page+1,n.a.createElement("button",{onClick:this.nextPage,className:"page-btn"},"Next Page"))),n.a.createElement("div",{id:"col3",style:{width:3===this.state.step_nbr?"100%":"0%"}},n.a.createElement("button",{onClick:function(){return t.testFunction(2)},className:"btn",style:{float:"left"}},"<<<<<"),n.a.createElement("div",{className:"dud-btn",style:{float:"right"}},"<<<<<"),this.state.token&&3===this.state.step_nbr&&n.a.createElement("div",{style:{alignItems:"center"}},n.a.createElement("p",null,"Select Spotify Playlist to import songs to."),n.a.createElement("button",{onClick:this.importSongs,className:"btn import-btn"},"IMPORT"),n.a.createElement(f,{playlists:this.state.playlists,action:this.selectPlaylist,selected:this.state.sel_playlist}))))}}]),a}(s.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));l.a.render(n.a.createElement(n.a.StrictMode,null,n.a.createElement(_,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(t){t.unregister()})).catch((function(t){console.error(t.message)}))}],[[13,1,2]]]);
//# sourceMappingURL=main.9849fa84.chunk.js.map