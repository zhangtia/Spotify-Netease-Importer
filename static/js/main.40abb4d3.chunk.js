(this["webpackJsonpplaylist-importer"]=this["webpackJsonpplaylist-importer"]||[]).push([[0],{11:function(e,t,a){e.exports=a(18)},16:function(e,t,a){},17:function(e,t,a){},18:function(e,t,a){"use strict";a.r(t);var n=a(0),s=a.n(n),i=a(10),l=a.n(i),c=(a(16),a(7)),r=a(3),o=a(4),u=a(1),m=a(6),p=a(5),h=a(2),d=["user-top-read","user-read-currently-playing","user-read-playback-state","playlist-modify-public","playlist-modify-private"],g=window.location.hash.substring(1).split("&").reduce((function(e,t){if(t){var a=t.split("=");e[a[0]]=decodeURIComponent(a[1])}return e}),{});window.location.hash="";var f=g,y=(a(9),function(e){Object(m.a)(a,e);var t=Object(p.a)(a);function a(){return Object(r.a)(this,a),t.apply(this,arguments)}return Object(o.a)(a,[{key:"render",value:function(){var e=this;return s.a.createElement("div",{className:"App-playlist"},this.props.playlists.map((function(t){return s.a.createElement("div",{key:t.id,onClick:function(){return e.props.action(t.id)}},s.a.createElement("div",{className:"main-wrapper btn",style:{background:e.props.selected===t.id?"#1ecd97":"",color:e.props.selected===t.id?"#333":""}},s.a.createElement("div",{className:"now-playing__img"},s.a.createElement("img",{className:"album-img",src:0!==t.images.length?t.images[0].url:"https://img.icons8.com/material-sharp/24/000000/no-image.png",alt:"album-cover"})),s.a.createElement("div",{className:"now-playing__side"},s.a.createElement("div",{className:"now-playing__name"},t.name))))})))}}]),a}(n.Component)),b=(a(17),function(e){Object(m.a)(a,e);var t=Object(p.a)(a);function a(e){var n;return Object(r.a)(this,a),(n=t.call(this,e)).state={recommended:[]},n}return Object(o.a)(a,[{key:"componentDidMount",value:function(){var e=this;h.ajax({url:"http://musicapi.leanapp.cn/top/playlist",type:"GET",data:{limit:5,cat:"\u6b27\u7f8e"},success:function(t){e.setState({recommended:t.playlists})}})}},{key:"render",value:function(){var e=this;return s.a.createElement("div",{className:"Intro"},s.a.createElement("table",{className:"Intro-list"},s.a.createElement("thead",null,s.a.createElement("tr",null,s.a.createElement("th",{style:{fontSize:"1em"}},"Hot Playlists"))),s.a.createElement("tbody",null,this.state.recommended.map((function(t){return s.a.createElement("tr",{key:t.id,onClick:function(){return e.props.action(t.id)},className:"Song-row"},s.a.createElement("td",null,t.name))})))),s.a.createElement("img",{className:"album-img",src:"%PUBLIC_URL%/logo192.png",alt:"album-cover"}))}}]),a}(n.Component)),E=function(e){Object(m.a)(a,e);var t=Object(p.a)(a);function a(e){var n;return Object(r.a)(this,a),(n=t.call(this,e)).state={token:null,display_name:"not logged in",playlists:[],neteasesearch:463126179,NEsongs:[],sel_playlist:null,songs_to_import:[],current_page:0,step_nbr:1},n.hi=n.hi.bind(Object(u.a)(n)),n.getPlaylists=n.getPlaylists.bind(Object(u.a)(n)),n.getNetease=n.getNetease.bind(Object(u.a)(n)),n.searchSong=n.searchSong.bind(Object(u.a)(n)),n.importSongs=n.importSongs.bind(Object(u.a)(n)),n.selectPlaylist=n.selectPlaylist.bind(Object(u.a)(n)),n.handleChange=n.handleChange.bind(Object(u.a)(n)),n.selectAll=n.selectAll.bind(Object(u.a)(n)),n.prevPage=n.prevPage.bind(Object(u.a)(n)),n.nextPage=n.nextPage.bind(Object(u.a)(n)),n.testFunction=n.testFunction.bind(Object(u.a)(n)),n.selectRecommended=n.selectRecommended.bind(Object(u.a)(n)),n}return Object(o.a)(a,[{key:"componentDidMount",value:function(){var e=f.access_token;e&&(this.setState({token:e}),this.hi(e),this.getPlaylists(e))}},{key:"hi",value:function(e){var t=this;h.ajax({url:"https://api.spotify.com/v1/me",type:"GET",beforeSend:function(t){t.setRequestHeader("Authorization","Bearer "+e)},success:function(e){t.setState({display_name:e.display_name})}})}},{key:"getPlaylists",value:function(e){var t=this;h.ajax({url:"https://api.spotify.com/v1/me/playlists",type:"GET",data:{limit:50,offset:0},beforeSend:function(t){t.setRequestHeader("Authorization","Bearer "+e)},success:function(e){t.setState({playlists:e.items})}})}},{key:"importSongs",value:function(){var e=this;if(null!==this.state.sel_playlist){var t=Object(c.a)(this.state.NEsongs),a=[],n="";t.forEach((function(e,t){t%50===0&&(a.push(n.substring(0,n.length-1)),n=""),e[4]&&(n=n+e[5]+",",e[4]=!e[4])})),a.push(n.substring(0,n.length-1)),a.forEach((function(a){h.ajax({url:"\thttps://api.spotify.com/v1/playlists/"+e.state.sel_playlist+"/tracks?"+h.param({uris:a}),type:"POST",beforeSend:function(t){t.setRequestHeader("Authorization","Bearer "+e.state.token)},success:function(a){e.setState({NEsongs:t})}})}))}else alert("Please select a playlist")}},{key:"searchSong",value:function(e,t){var a=this;h.ajax({url:"https://api.spotify.com/v1/search",type:"GET",data:{q:"track:'"+e+"' artist:'"+t+"'",type:"track",limit:1},beforeSend:function(e){e.setRequestHeader("Authorization","Bearer "+a.state.token)},success:function(n){0!==n.tracks.items.length?a.setState((function(a){return{NEsongs:[].concat(Object(c.a)(a.NEsongs),[[e,t,n.tracks.items[0].name,n.tracks.items[0].artists[0].name,!1,n.tracks.items[0].uri]])}})):a.setState((function(a){return{NEsongs:[].concat(Object(c.a)(a.NEsongs),[[e,t,"N/A","N/A",!1,""]])}}))}})}},{key:"getNetease",value:function(e){var t=this;this.setState({NEsongs:[],step_nbr:2}),h.ajax({url:"https://musicapi.leanapp.cn/playlist/detail",type:"GET",data:{id:this.state.neteasesearch},success:function(e){console.log(e),200===e.code?e.playlist.trackIds.forEach((function(e){h.ajax({url:"https://musicapi.leanapp.cn/song/detail",type:"GET",data:{ids:e.id},success:function(e){t.searchSong(e.songs[0].name,e.songs[0].ar[0].name)}})})):alert("Error fetching playlist")}})}},{key:"selectSong",value:function(e,t){t.preventDefault();var a=Object(c.a)(this.state.NEsongs);"N/A"!==a[e][3]&&(a[e][4]=!a[e][4],this.setState({NEsongs:a}))}},{key:"selectPlaylist",value:function(e){this.setState({sel_playlist:e})}},{key:"handleChange",value:function(e){this.setState({neteasesearch:e.target.value})}},{key:"selectAll",value:function(){var e=Object(c.a)(this.state.NEsongs);e.forEach((function(e){"N/A"!==e[3]&&(e[4]=!0)})),this.setState({NEsongs:e})}},{key:"prevPage",value:function(){if(this.state.current_page>0){var e=this.state.current_page-1;this.setState({current_page:e})}}},{key:"nextPage",value:function(){if(20*(this.state.current_page+1)<this.state.NEsongs.length){var e=this.state.current_page+1;this.setState({current_page:e})}}},{key:"testFunction",value:function(e){this.setState({step_nbr:e})}},{key:"selectRecommended",value:function(e){var t=this;this.setState({neteasesearch:e,step_nbr:2,NEsongs:[]}),h.ajax({url:"https://musicapi.leanapp.cn/playlist/detail",type:"GET",data:{id:e},success:function(e){console.log(e),200===e.code?e.playlist.trackIds.forEach((function(e){h.ajax({url:"https://musicapi.leanapp.cn/song/detail",type:"GET",data:{ids:e.id},success:function(e){t.searchSong(e.songs[0].name,e.songs[0].ar[0].name)}})})):alert("Error fetching playlist")}})}},{key:"render",value:function(){var e=this;return s.a.createElement("div",{className:"App"},s.a.createElement("ul",{className:"navbar"},s.a.createElement("li",null,"first"),s.a.createElement("li",null,"first"),s.a.createElement("li",null,"first"),s.a.createElement("li",null,"first"),s.a.createElement("li",null,"first")),s.a.createElement("div",{id:"col1",style:{width:1===this.state.step_nbr?"100%":"0%"}},this.state.token&&this.state.NEsongs.length>0&&s.a.createElement("button",{onClick:function(){return e.testFunction(2)},className:"btn",style:{float:"right"}},">>>>>"),!this.state.token&&s.a.createElement("header",{className:"App-header"},s.a.createElement("a",{className:"btn btn--loginApp-link",href:"".concat("https://accounts.spotify.com/authorize","?client_id=").concat("60707a33a22f4caaa987faa27cd9251b","&redirect_uri=").concat("https://zhangtia.github.io/Spotify-Netease-Importer/","&scope=").concat(d.join("%20"),"&response_type=token&show_dialog=true")},"Login to Spotify")),this.state.token&&1===this.state.step_nbr&&s.a.createElement("form",{onSubmit:this.getNetease},s.a.createElement("label",null,s.a.createElement("input",{type:"text",name:"user",value:this.state.neteasesearch,onChange:this.handleChange,className:"input-field"})),s.a.createElement("input",{type:"submit",value:"get playlist",className:"submit-btn"})),this.state.token&&s.a.createElement(b,{action:this.selectRecommended})),s.a.createElement("div",{id:"col2",style:{width:2===this.state.step_nbr?"100%":"0%"}},s.a.createElement("button",{onClick:function(){return e.testFunction(1)},className:"btn",style:{float:"left"}},"<<<<<"),s.a.createElement("button",{onClick:function(){return e.testFunction(3)},className:"btn",style:{float:"right"}},">>>>>"),0!==this.state.NEsongs.length&&2===this.state.step_nbr&&s.a.createElement("div",{className:"control-panel"},s.a.createElement("button",{onClick:this.selectAll,className:"btn"},"SELECT ALL"),s.a.createElement("button",{onClick:this.prevPage,className:"page-btn left-space"},"Previous Page"),this.state.current_page+1,s.a.createElement("button",{onClick:this.nextPage,className:"page-btn"},"Next Page")),this.state.token&&2===this.state.step_nbr&&s.a.createElement("table",{className:"Song-list"},s.a.createElement("thead",null,s.a.createElement("tr",null,s.a.createElement("th",{style:{fontSize:"0.7em"}},"Netease"),s.a.createElement("th",{style:{fontSize:"0.7em"}},"Spotify"),s.a.createElement("th",{style:{fontSize:"0.7em"}},"Import?"))),s.a.createElement("tbody",null,this.state.NEsongs.slice(20*this.state.current_page,20*(this.state.current_page+1)).map((function(t,a){return s.a.createElement("tr",{key:t[0],onClick:e.selectSong.bind(e,20*e.state.current_page+a),className:"Song-row"},s.a.createElement("td",{style:{background:t[4]?"#1ecd97":"",color:t[4]?"#333":""}},s.a.createElement("p",{className:"Song-name"},t[0]),s.a.createElement("p",{className:"Artist-name"},t[1])),s.a.createElement("td",{style:{background:t[4]?"#1ecd97":"",color:t[4]?"#333":""}},s.a.createElement("p",{className:"Song-name"},t[2]),s.a.createElement("p",{className:"Artist-name"},t[3])),s.a.createElement("td",{style:{background:t[4]?"#1ecd97":"",color:t[4]?"#333":""}},"[]"))}))))),s.a.createElement("div",{id:"col3",style:{width:3===this.state.step_nbr?"100%":"0%"}},s.a.createElement("button",{onClick:function(){return e.testFunction(2)},className:"btn",style:{float:"left"}},"<<<<<"),this.state.token&&3===this.state.step_nbr&&s.a.createElement("div",{style:{alignItems:"center"}},s.a.createElement("button",{onClick:this.importSongs,className:"btn"},"IMPORT"),s.a.createElement(y,{playlists:this.state.playlists,action:this.selectPlaylist,selected:this.state.sel_playlist}))))}}]),a}(n.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));l.a.render(s.a.createElement(s.a.StrictMode,null,s.a.createElement(E,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},9:function(e,t,a){}},[[11,1,2]]]);
//# sourceMappingURL=main.40abb4d3.chunk.js.map